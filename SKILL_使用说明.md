# SKILL: 批量更新设备存放地 - 使用说明

## 功能描述

自动从Excel文件读取设备信息，批量更新内网资产管理系统的"学院存放地"字段。

## 使用方法

### 方法1：直接运行（推荐）

```bash
cd "F:\技术部工作内容\2026年工作内容记录\260227修改设备信息(未完成)"
python 批量更新设备存放地.py
```

### 方法2：修改配置后运行

打开 `批量更新设备存放地.py`，修改以下配置：

```python
EXCEL_FILE = "存放地测试.xlsx"  # 改成你的Excel文件名

MANUAL_LOGIN = True  # 手动登录模式
WAIT_TIME = 3  # 根据网络速度调整（2-5秒）
```

然后运行：
```bash
python 批量更新设备存放地.py
```

## 操作流程

1. **启动脚本** - 自动打开Chrome浏览器

2. **手动登录**（30秒）
   - 在打开的浏览器中登录系统
   - 脚本会自动点击"管理员资产管理"

3. **自动批量处理**
   - 自动搜索资产编号
   - 自动点击编辑
   - 自动填入新存放地（从Excel"学院新存放地"列读取）
   - 自动点击保存
   - 自动确认弹窗

4. **查看结果**
   - 控制台显示实时进度
   - 日志文件保存所有操作记录

## Excel文件格式要求

| 列名 | 必填 | 说明 |
|------|------|------|
| 资产编号 | ✅ | 要查询的资产编号 |
| 学院新存放地 | ✅ | 要更新的新存放地 |

**示例：**
| 序号 | 资产编号 | 名称 | 型号 | 学院存放地 | 学院新存放地 |
|------|----------|------|------|------------|--------------|
| 1 | 18003356 | 设备A | XX | 旧位置 | 华家池校区教学楼213 |
| 2 | 18003357 | 设备B | YY | 旧位置 | 紫金港校区A栋101 |

## 注意事项

1. **登录时间** - 启动后有30秒时间登录，请提前准备好账号密码
2. **网络速度** - 如果网络较慢，增加 `WAIT_TIME` 的值
3. **数据备份** - 虽然只修改"学院存放地"字段，但仍建议先备份数据
4. **保持窗口可见** - 脚本运行时不要最小化或遮挡浏览器窗口
5. **中途停止** - 按 Ctrl+C 可随时中断

## 故障排除

### 问题1：找不到ChromeDriver
**解决：** 下载ChromeDriver并放到系统PATH或脚本同目录

### 问题2：找不到元素
**解决：** 页面结构可能变化，需要重新获取元素XPath

### 问题3：处理速度慢
**解决：** 减少 `WAIT_TIME` 的值（最小2秒）

## 输出文件

运行后会生成：
- `update_log_YYYYMMDD_HHMMSS.txt` - 操作日志
- 包含成功/失败统计和详细记录

## 技术支持

如遇问题，检查：
1. ChromeDriver版本是否匹配
2. Excel文件格式是否正确
3. 网络连接是否正常
4. 日志文件中的错误信息
